# ELB란? TLS, SSL과 HTTPS

HTTPS 적용에 대해 알아볼 예정인데, AWS 서비스 중 ELB를 사용할 예정.
ELB 에 대해 살펴볼 것.
ELB 란 Elastic Load Balancer 의 줄임말로 트래픽(부하)을 적절하게 분배해주는 장치이다. 
트래픽을 적절하게 분배해주는 장치를 보고 개발적으로 로드 밸런서 (Load Balancer) 라고 부른다.
이때 Load 가 부하를 의미, 균형있게 분배해주겠다는 의미.
서버를 2대 이상 가용할 때 ELB를 필수적으로 도입하게 된다.

<img width="503" src="https://github.com/al1kite/AWS-wiki/assets/102217402/d2951538-d0c2-495c-b5e4-f5c3d78e8de1">

트래픽이 ELB 를 향해 쏟아지게 된다면 여러 EC2 인스턴스한테 골고루 요청을 나눠 보내주는 역할을 하는 것.
다만 우리는 현재 ELB의 로드밸런서 기능은 사용하지 않고 ELB의 부가 기능인 SSL/TLS(HTTPS)를 적용시키는 방법에 대해 배울 것.

### SSL/TLS 란?
SSL/TLS 쉽게 표현하자면 HTTP를 HTTPS로 바꿔주는 인증서.
ELB는 SSL/TLS 기능을 제공 : SSL/TLS 인증서를 활용해 HTTP가 아닌 HTTPS로 통신할 수 있게 만들어준다. 

### HTTPS 란?
HTTPS 를 적용시켜야 하는 이유는 크게 2가지이다.
1. 보안적인 이유
HTTP 로 통신하면 통신하는 것 자체의 데이터를 암호화 없이 그대로 보내기에 중간에 가로챌 수 있다.
가로챈다는 건 내가 보낸 데이터를 볼 수 있는데, 로그인이라면 아이디, 비밀번호 혹은 주민등록번호일 수도.
이런 게 노출되면 안되기 때문에 HTTPS 적용. -> 그냥 데이터를 보내기 전 암호화 해서 보낸 후 복호화해 응답 데이터를 처리.
따라서 중간에 가로채더라도 암호화 되어있기 때문에 정보 노출이 되지 않는 것.
2. 적용 안시길 시 브라우저 경고로 인한 사용자 이탈
경고로 인해 믿음직스럽지 못한 사이트라 판단하기 때문에 사용자 이탈

HTTPS 인증을 받은 웹 사이트가 백엔드 서버와 통신하려면, 백엔드 서버의 주소도 HTTPS 인증을 받아야 한다. 
HTTPS 가 아닌 ip 주소로 통신하면 브라우저 자체에서 에러를 띄우고 통신을 막는다.
따라서 백엔드 서버와 통신할 때도 IP 주소로 통신하는 게 아니라, HTTPS 인증을 받은 도메인 주소로 통신을 한다. 

주로 도메인을 구성할 때 아래와 같이 많이 구성한다.

- 웹 사이트 주소 : `**https**://al1kite.co.kr`
- 백엔드 API 서버 주소 : `**https**://api.al1kite.co.kr`

웹사이트 같은 경우 우리가 구매한 도메인으로 주로 구성하고,
백엔드 서버 같은 경우 앞에 api 를 붙여 많이 도메인 나눠 사용.
앞에 하나의 도메인만 구매하면 앞에 어떤 값을 붙이는지는 자유롭게 선택해서 설정할 수 있다.

# ELB를 활용한 아키텍처 구성

그 다음으로 우리가 체크해야 할 건, ELB 를 쓸 건데 전체적인 그림에서
어떻게 ELB 가 적용이 되는지, ELB 를 어떤 구조로 써야하는지를 그림으로 먼저 파악하고 갈 것. 
<img width="249" src="https://github.com/al1kite/AWS-wiki/assets/102217402/c6f1e080-e3df-441d-959c-30ff007cb383">
우리가 기존에 EC2 백엔드 서버를 띄운 건, 사용자들이 요청을 보내 받아가는 형식이었다.
그런데 ELB 를 도입해서 어떤 식으로 바꿀 거냐면, 이런 형태로 바꿀 것. 사용자가 EC2 에 직접적으로 요청을 보내는게 아닌, ELB에 요청을 보내면 ELB가 EC2에게 전달해주는 형식으로 구성을 바꿀 것.

<img width="403" src="https://github.com/al1kite/AWS-wiki/assets/102217402/d691dc90-da2b-4360-bec1-3799349fe0d6">

이 이유는 나중에 EC2 서버가 늘어날 시 나눠서 서버에 요청을 보내기 위함인데, 사용자가 직접 EC2 에 보낼 시 알아서 분리해서 보내기 어려워진다.

<img width="419" src="https://github.com/al1kite/AWS-wiki/assets/102217402/13b992fc-6fb2-4721-8ade-af671489c86a">

사용자 입장에선 EC2 로 직접 요청을 보내는게 아닌 ELB에 보낼 거고, ELB도 ELB 만의 ip, 도메인 주소를 가지고 있게 된다. 얘도 결국 하나의 컴퓨터.
이 컴퓨터에게 사용자들이 요청을 보내게끔 구성을 바꾼다는 것.

구성을 사용자들이 EC2 가 아닌 ELB 에 요청을 보내야 하기 때문에 구성을 기존 EC2 에 적용시켰던 도메인을 ELB에 적용되도록 변경할 것.
그리고 HTTPS 도 ELB 에 연결시킨 도메인에 적용시키는 식으로 바꿀 것.