## 웹 서비스를 배포할 때 사용하는 S3, CloudFront

S3 는 파일 저장 서비스라 배웠는데, 
사실 S3 는 그 기능 이외에도 여러가지 부가 기능들을 가지고 있다.
그 부가 기능 중 하나가 정적 웹사이트 호스팅 기능이다. 
쉽게 표현하자면 웹 서비스를 다른 사용자들도 쓸 수 있게 인터넷에 배포하는 것을 의미한다.

#### CloudFront 란? 

웹페이지 파일, index.html, 동영상, 이미지 등 파일들을 다 포함한 컨텐츠를 빠르게 전송하게 해주는 서비스를 AWS Cloudfront 이다.
그럼 이 AWS 클라우드 프론트가 어떻게 컨텐츠를 빠르게 전송해주는지 작동 과정을 살펴볼 예정.

![image](https://github.com/cotes2020/jekyll-theme-chirpy/assets/102217402/abf83f13-b10b-4a67-82dc-65f764bd37ce)
 
우리는 컨텐츠, 클라우드 프론트를 쓰기 전에는 오리진 서버 (이때 오리진 서버는 S3라 생각하면 된다) S3에 저장한 원본 파일을 거리가 먼 사람에게 전송하기 위해서는 속도가 느려지게 된다.
이런 문제점을 해결하기 위해 임시 저장소인 중간 저장소들을 많이 나둬 컨텐츠의 복사본을 저장해놓을 수 있게 한다.
S3에 어떤 동영상 파일을 하나 올렸다고 할 때, 이 동영상 파일을 곳곳에 복사해 다 받아놔 오리진 서버를 통해 받아오는게 아닌 가장 가까운 임시 저장소 서버에서 그 동영상 파일을 받아온다.
이점은 거리가 가깝기 때문에 다운로드 받는 속도가 빨라진다. 이러한 형태의 서비스를 CDN 이라 한다. 그래서 이 클라우드 프론트를 CDN 서비스라고도 표현한다.

그럼 클라우드 프론트는 왜 사용하는 걸까?

S3 정적 웹사이트 호스팅 기능을 갖고 있으므로 그것만 갖고 웹사이트를 배포할 수 있는데 왜 클라우드 프론트를 붙이냐 하면
이 컨텐츠를 전송받는 성능을 향상시키기 위해 즉 우리 어떤 웹페이지가 뜨는, 다운로드 받는 시간의 속도를 줄여준다.
이 뿐만 아니라 HTTPS를 적용시키기 위해 클라우드 프론트를 사용할 것이다.
아쉽게도 S3에서는 HTTPS 를 적용시키는 기능을 제공하지 않는다. 그러므로 우리는 클라우드 프론트를 써서 이 웹페이지 자체에 HTTPS 가 적용될 수 있게끔 만들 것이고, 그것 이외에도 보안적으로 강화할 수 있는 부가 기능도 존재한다.

이러한 장점들 덕분에 웹서비스를 배포할 때는 일반적으로 S3랑 클라우드 프론트를 같이 조합해 배포하고 있다.

참고로 웹 서비스를 배포할 때 S3, CloudFront도 많이 사용하지만, Netlify, Vercel, Cloudflare와 같은 서비스를 사용하기도 한다.

## S3, CloudFront를 활용한 아키텍처 구성

![img](https://github.com/cotes2020/jekyll-theme-chirpy/assets/102217402/4a6677f3-e19e-4a3b-815d-37b6c6b91d2f)

사용자가 요청을 보내 웹사이트 페이지의 컨텐츠를 전달받아야 하는데, 이를 임시저장소인 cloudfront 를 통해 거쳐 받을 예정이다.
s3 로 직접 받지 않고 클라우드 프론트가 s3 에서 컨텐츠를 가져와 유저에게 전달해준다.
만약 s3에서 이미 가져온 상태라면 s3를 굳이 거치지 않아도 임시 저장된 곳에서 바로 유저에게 전달해주게 된다.
